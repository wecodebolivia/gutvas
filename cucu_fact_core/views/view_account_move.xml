<?xml version="1.0" encoding="utf-8"?>
<!-- Copyright (c) 2021-Present cucu | soluciones digitales -->
<!-- See LICENSE file for full copyright and licensing details. -->
<odoo>
    <record id="view_move_form_inherit" model="ir.ui.view">
        <field name="name">account.move.form.inherit</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="account.view_move_form"/>
        <field name="arch" type="xml">
            <xpath expr="//group[@id='header_left_group']//field[@name='partner_id']" position="attributes">
                <attribute name="required">is_sin</attribute>
            </xpath>
            <xpath expr="//header" position="inside">
                <button name="%(cucu_fact_core.action_cancel_wizard)d" string="Invoice Siat Options" type="action" class="oe_highlight" invisible="state == 'draft'" groups="base.group_user"/>
                <div class="btn-group" invisible="state == 'draft'">
                    <button type="button" class="btn btn-info dropdown-toggle" data-bs-toggle="dropdown" name="object">
                        Report Cucu
                    </button>
                    <ul class="dropdown-menu">
                        <li>
                            <a type="object" class="dropdown-item" name="action_report_invoice_sin">Report SIN</a>
                        </li>
                        <li>
                            <a type="object" class="dropdown-item" name="action_report_invoice_a4">Report A4</a>
                        </li>
                        <li>
                            <a type="object" class="dropdown-item" name="action_report_invoice_ticket">Report Ticket</a>
                        </li>
                    </ul>
                </div>
            </xpath>
            <xpath expr="//form//sheet//group" position="after">
                <group id="group_cucu_invoice" invisible="is_sin == False">
                    <group string="Datos Cliente" id="group_cucu_clients">
                        <field name="client_doc_id" widget="many2one" invisible="is_sin == False" readonly="sin_code_reception != '0000'" options="{'no_quick_create':True,'no_create_edit':True,'no_open': True}"/>
                        <field name="client_complement" invisible="is_sin == False" readonly="sin_code_reception != '0000'"/>
                        <field name="client_nro_document" invisible="is_sin == False" readonly="sin_code_reception != '0000'"/>
                        <field name="client_reason_social" string="Name legal" invisible="is_sin == False" readonly="sin_code_reception != '0000'"/>
                        <field name="client_email" invisible="is_sin == False" readonly="sin_code_reception != '0000'"/>
                    </group>
                    <group string="Datos factura">
                        <field name="sin_code_reception" invisible="1"/>
                        <field name="payment_method_id" string="Payment method" widget="many2one" options="{'no_quick_create':True,'no_create_edit':True,'no_open': True}" domain="[('is_visible', '=', True),('company_id','=',allowed_company_ids[0])]" invisible="is_sin == False" required="is_sin == True" readonly="sin_code_reception != '0000'"/>
                        <field name="payment_method_code" invisible="1"/>
                        <field name="additional_discount" invisible="is_sin == False" readonly="sin_code_reception != '0000'"/>
                        <field name="amount_gift_card" readonly="sin_code_reception != '0000'" invisible="payment_method_code not in ['27','40']"/>
                        <field name="number_card" widget="card" required="payment_method_code  in ['2','40']" invisible="payment_method_code not in ['2','40']"/>
                        <field name="observations" invisible="is_sin == False" readonly="sin_code_reception != '0000'"/>

                        <field name="sin_description_status" invisible="is_sin == False" string="Sin Status" widget="badge" decoration-success="sin_description_status in ['VALIDADA','VALIDA']" decoration-danger="sin_description_status in ['ANULACION CONFIRMADA', 'ANULADA']" decoration-warning="sin_description_status in ['REVERSION DE ANULACION CONFIRMADA']" readonly="sin_code_reception != '0000'"/>
                    </group>
                </group>
            </xpath>
            <xpath expr="//group[@id='header_left_group']" position="inside">
                <field name="is_sin" string="Facturar productos"/>
                <field name="pos_id" required="True" invisible="is_sin == False" readonly="sin_code_reception != '0000'" options="{'no_quick_create':True,'no_create_edit':True,'no_open': True}"/>
            </xpath>
            <xpath expr="//group[@id='header_right_group']" position="inside">
            </xpath>

            <xpath expr="//page" position="after">
                <page id="fact_documents" string="FacturaciÃ³n en Linea" invisible="not is_sin">
                    <field name="invoice_id" string="Status Invoice SIN">
                        <list create="0" delete="0" edit="0">
                            <field name="invoice_code"/>
                            <field name="payment_method_code"/>
                            <field name="invoice_number"/>
                            <field name="amount_total"/>
                            <field name="sin_code_state"/>
                            <field name="sin_code_reception"/>
                            <field name="sin_description_status"/>
                            <field name="date_emission"/>
                            <button name="handle_status_invoice" type="object" class="btn-secondary o_button_icon" icon="fa-check-circle"/>
                            <!--                            <button name="handle_cancel_invoice" type="object" class="btn-secondary o_button_icon" icon="fa-ban"/>-->
                            <field name="cuf" optional="1"/>
                            <field name="branch_id" optional="1"/>
                            <field name="pos_id" optional="1"/>
                            <field name="nit_emissor" optional="1"/>
                            <field name="count_items" optional="1"/>
                            <field name="amount_literal" optional="1"/>
                        </list>
                        <form edit="1" create="1" string="Status Invoice SIN">
                            <sheet>
                                <group>
                                    <group>
                                        <field name="invoice_code" readonly="1"/>
                                        <field name="sin_code_state" readonly="1"/>
                                        <field name="payment_method_code" readonly="1"/>
                                        <field name="sin_code_reception" readonly="1"/>
                                        <field name="sin_description_status" readonly="1"/>
                                        <field name="cuf" readonly="1"/>
                                        <field name="invoice_number" readonly="1"/>
                                        <field name="date_emission" readonly="1"/>
                                    </group>
                                    <group>
                                        <field name="branch_id" readonly="1"/>
                                        <field name="pos_id" readonly="1"/>
                                        <field name="nit_emissor" readonly="1"/>
                                        <field name="amount_total" readonly="1"/>
                                        <field name="count_items" readonly="1"/>
                                        <field name="amount_literal" readonly="1"/>
                                    </group>
                                </group>
                                <notebook>
                                    <page string="Status SIN">
                                        <field name="log_ids">
                                            <list create="0" edit="0">
                                                <field name="type_event"/>
                                                <field name="json_response"/>
                                            </list>
                                        </field>
                                    </page>
                                </notebook>
                            </sheet>
                            <footer>
                                <button name="get_url_sin" string="Ver Factura SIN" type="object" class="btn-dark"/>
                                <button name="get_url_a4" string="Ver Factura Cucu A4" type="object" class="btn-outline-secondary"/>
                                <button name="get_url_ticket" string="Ver Factura Cucu Ticket" type="object" class="btn-outline-secondary"/>
                            </footer>
                        </form>
                    </field>
                </page>
                <page id="fact_invoice_xml" string="Factura SIN XML" invisible="is_sin == False">
                    <group>
                        <field name="invoice_xml" readonly="1" widget="ace" options="{'mode': 'xml'}"/>
                    </group>
                </page>
                <page id="fact_invoice_xml" string="Factura SIN JSON" invisible="is_sin == False">
                    <group>
                        <!-- <field name="invoice_json" readonly="1" widget="ace" options="{'mode': 'json'}"/> -->
                        <field name="invoice_json" readonly="1" widget="ace" options="{'language': 'json'}"/>
                    </group>
                </page>
            </xpath>
        </field>
    </record>

    <record id="view_move_list_inherit" model="ir.ui.view">
        <field name="name">account.move.list.inherit</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="account.view_out_invoice_tree"/>
        <field name="arch" type="xml">
            <field name="status_in_payment" position="before">
                <field name="sin_description_status" widget="badge" decoration-success="sin_description_status in ['VALIDADA','VALIDA']" decoration-danger="sin_description_status in ['ANULACION CONFIRMADA', 'ANULADA']" decoration-warning="sin_description_status in ['REVERSION DE ANULACION CONFIRMADA']"/>
                <field name="invoice_number"/>
                <field name="doc_sector"/>
            </field>
        </field>
    </record>
</odoo>
