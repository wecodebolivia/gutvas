<?xml version="1.0" encoding="UTF-8"?>
<odoo>

  <!-- 1️⃣ WRAPPER: este es el que usa ir.actions.report -->
  <template id="cucu_report_account" name="CUCU - Factura">
    <t t-call="web.html_container">
      <t t-foreach="docs" t-as="o">
        <t t-set="lang" t-value="o.partner_id.lang or o.env.user.lang"/>
        <t t-set="o" t-value="o.with_context(lang=lang)"/>
        <t t-set="proforma" t-value="data.get('proforma') if data else False"/>
        <t t-set="print_with_payments" t-value="data.get('print_with_payments') if data else False"/>

        <!-- llamada limpia al template estándar -->
        <t t-call="account.report_invoice_document"/>
      </t>
    </t>
  </template>

  <!-- 2️⃣ HERENCIA: aquí tocamos SOLO el título -->
  <template id="cucu_invoice_title_fix"
            inherit_id="account.report_invoice_document">

    <xpath expr="//t[@t-set='layout_document_title']" position="replace">
      <t t-set="layout_document_title">
        <span>Factura</span>
        <t t-if="o.name and o.name != '/'">
          <span style="margin-left:6px;" t-field="o.name"/>
        </t>
      </t>
    </xpath>

  </template>

</odoo>
